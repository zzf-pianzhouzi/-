{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport request from \"@/utils/request\";\nimport ValidCode from \"@/components/ValidCode\";\nimport { activeRouter } from \"@/utils/permission\";\nexport default {\n  name: \"Login\",\n  components: {\n    ValidCode\n  },\n\n  data() {\n    return {\n      vedioCanPlay: false,\n      fixStyle: '',\n      form: {\n        role: 1\n      },\n      rules: {\n        username: [{\n          required: true,\n          message: '请输入用户名',\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          message: '请输入密码',\n          trigger: 'blur'\n        }]\n      },\n      validCode: '' // 加背景图片\n      // bg: {\n      //   backgroundImage: \"url(\" + require(\"@/assets/bg.jpg\") + \")\",\n      //   backgroundRepeat: \"no-repeat\",\n      //   backgroundSize: \"100% 100%\"\n      // }\n\n    };\n  },\n\n  mounted() {\n    sessionStorage.removeItem(\"user\");\n\n    window.onresize = () => {\n      const windowWidth = document.body.clientWidth;\n      const windowHeight = document.body.clientHeight;\n      const windowAspectRatio = windowHeight / windowWidth;\n      let videoWidth;\n      let videoHeight;\n\n      if (windowAspectRatio < 0.5625) {\n        videoWidth = windowWidth;\n        videoHeight = videoWidth * 0.5625;\n        this.fixStyle = {\n          height: windowWidth * 0.5625 + 'px',\n          width: windowWidth + 'px',\n          'margin-bottom': (windowHeight - videoHeight) / 2 + 'px',\n          'margin-left': 'initial'\n        };\n      } else {\n        videoHeight = windowHeight;\n        videoWidth = videoHeight / 0.5625;\n        this.fixStyle = {\n          height: windowHeight + 'px',\n          width: windowHeight / 0.5625 + 'px',\n          'margin-left': (windowWidth - videoWidth) / 2 + 'px',\n          'margin-bottom': 'initial'\n        };\n      }\n    };\n\n    window.onresize();\n  },\n\n  methods: {\n    canplay() {\n      this.vedioCanPlay = true;\n    },\n\n    // 接收验证码组件提交的 4位验证码\n    createValidCode(data) {\n      this.validCode = data;\n    },\n\n    login() {\n      this.$refs['form'].validate(valid => {\n        if (valid) {\n          if (!this.form.validCode) {\n            this.$message.error(\"请填写验证码\");\n            return;\n          }\n\n          if (this.form.validCode.toLowerCase() !== this.validCode.toLowerCase()) {\n            this.$message.error(\"验证码错误\");\n            return;\n          }\n\n          request.post(\"/user/login\", this.form).then(res => {\n            if (res.code === '0') {\n              this.$message({\n                type: \"success\",\n                message: \"登录成功\"\n              });\n              sessionStorage.setItem(\"user\", JSON.stringify(res.data)); // 缓存用户信息\n              // 登录成功的时候更新当前路由\n\n              activeRouter();\n              this.$router.push(\"/\"); //登录成功之后进行页面的跳转，跳转到主页\n            } else {\n              this.$message({\n                type: \"error\",\n                message: res.msg\n              });\n            }\n          });\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["request","ValidCode","activeRouter","name","components","data","vedioCanPlay","fixStyle","form","role","rules","username","required","message","trigger","password","validCode","mounted","sessionStorage","removeItem","window","onresize","windowWidth","document","body","clientWidth","windowHeight","clientHeight","windowAspectRatio","videoWidth","videoHeight","height","width","methods","canplay","createValidCode","login","$refs","validate","valid","$message","error","toLowerCase","post","then","res","code","type","setItem","JSON","stringify","$router","push","msg"],"sourceRoot":"","sources":["D:\\Desktop\\springboot+vue\\springboot-vue-demo\\src\\views\\Login.vue"],"sourcesContent":["<template>\n  <div class=\"homepage-hero-module\">\n    <div class=\"video-container\">\n      <div :style=\"fixStyle\" class=\"filter\">\n        <div style=\"width: 400px; margin: 100px auto\">\n          <div style=\"font-size: 30px; text-align: center; padding: 30px 0; color: #333\">欢迎登录</div>\n          <el-form ref=\"form\" :model=\"form\" size=\"normal\" :rules=\"rules\">\n            <el-form-item prop=\"username\">\n              <el-input prefix-icon=\"el-icon-user-solid\" v-model=\"form.username\" placeholder=\"请输入账号\"></el-input>\n            </el-form-item>\n            <el-form-item prop=\"password\">\n              <el-input prefix-icon=\"el-icon-lock\" v-model=\"form.password\" show-password placeholder=\"请输入密码\"></el-input>\n            </el-form-item>\n            <el-form-item>\n              <div style=\"display: flex\">\n                <el-input prefix-icon=\"el-icon-key\" v-model=\"form.validCode\" style=\"width: 50%;\" placeholder=\"请输入验证码\"></el-input>\n                <ValidCode @input=\"createValidCode\" />\n              </div>\n            </el-form-item>\n<!--            <el-form-item>-->\n<!--              <el-radio v-model=\"form.role\" :label=\"1\" style=\"color: white\">管理员</el-radio>-->\n<!--              <el-radio v-model=\"form.role\" :label=\"2\" style=\"color: white\">普通用户</el-radio>-->\n<!--            </el-form-item>-->\n            <el-form-item>\n              <el-button style=\"width: 100%\" type=\"primary\" @click=\"login\">登 录</el-button>\n            </el-form-item>\n            <el-form-item><el-button type=\"text\" @click=\"$router.push('/register')\">前往注册 >> </el-button></el-form-item>\n          </el-form>\n        </div>\n      </div>\n      <video :style=\"fixStyle\" autoplay loop muted class=\"fillWidth\" v-on:canplay=\"canplay\">\n        <source src=\"../assets/sea.mp4\" type=\"video/mp4\"/>\n        浏览器不支持 video 标签，建议升级浏览器。\n      </video>\n    </div>\n  </div>\n\n</template>\n\n<script>\nimport request from \"@/utils/request\";\nimport ValidCode from \"@/components/ValidCode\";\nimport {activeRouter} from \"@/utils/permission\";\n\nexport default {\n  name: \"Login\",\n  components: {\n    ValidCode,\n  },\n  data() {\n    return {\n      vedioCanPlay: false,\n      fixStyle: '',\n      form: {role: 1},\n      rules: {\n        username: [\n          {required: true, message: '请输入用户名', trigger: 'blur'},\n        ],\n        password: [\n          {required: true, message: '请输入密码', trigger: 'blur'},\n        ],\n      },\n      validCode: ''\n      // 加背景图片\n      // bg: {\n      //   backgroundImage: \"url(\" + require(\"@/assets/bg.jpg\") + \")\",\n      //   backgroundRepeat: \"no-repeat\",\n      //   backgroundSize: \"100% 100%\"\n      // }\n    }\n  },\n  mounted() {\n    sessionStorage.removeItem(\"user\")\n\n    window.onresize = () => {\n      const windowWidth = document.body.clientWidth\n      const windowHeight = document.body.clientHeight\n      const windowAspectRatio = windowHeight / windowWidth\n      let videoWidth\n      let videoHeight\n      if (windowAspectRatio < 0.5625) {\n        videoWidth = windowWidth\n        videoHeight = videoWidth * 0.5625\n        this.fixStyle = {\n          height: windowWidth * 0.5625 + 'px',\n          width: windowWidth + 'px',\n          'margin-bottom': (windowHeight - videoHeight) / 2 + 'px',\n          'margin-left': 'initial'\n        }\n      } else {\n        videoHeight = windowHeight\n        videoWidth = videoHeight / 0.5625\n        this.fixStyle = {\n          height: windowHeight + 'px',\n          width: windowHeight / 0.5625 + 'px',\n          'margin-left': (windowWidth - videoWidth) / 2 + 'px',\n          'margin-bottom': 'initial'\n        }\n      }\n    }\n    window.onresize()\n  },\n  methods: {\n    canplay() {\n      this.vedioCanPlay = true\n    },\n    // 接收验证码组件提交的 4位验证码\n    createValidCode(data) {\n      this.validCode = data\n    },\n    login () {\n      this.$refs['form'].validate((valid) => {\n        if (valid) {\n          if (!this.form.validCode) {\n            this.$message.error(\"请填写验证码\")\n            return\n          }\n          if(this.form.validCode.toLowerCase() !== this.validCode.toLowerCase()) {\n            this.$message.error(\"验证码错误\")\n            return\n          }\n          request.post(\"/user/login\", this.form).then(res => {\n            if (res.code === '0') {\n              this.$message({\n                type: \"success\",\n                message: \"登录成功\"\n              })\n              sessionStorage.setItem(\"user\", JSON.stringify(res.data))  // 缓存用户信息\n\n              // 登录成功的时候更新当前路由\n              activeRouter()\n              this.$router.push(\"/\")  //登录成功之后进行页面的跳转，跳转到主页\n\n            } else {\n              this.$message({\n                type: \"error\",\n                message: res.msg\n              })\n            }\n          })\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.homepage-hero-module,\n.video-container {\n  position: relative;\n  height: 100vh;\n  overflow: hidden;\n}\n\n.video-container .poster img{\n  z-index: 0;\n  position: absolute;\n}\n\n.video-container .filter {\n  z-index: 1;\n  position: absolute;\n  /*background: rgba(0, 0, 0, 0.4);*/\n  width: 100%;\n}\n\n.fillWidth {\n  width: 100%;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}